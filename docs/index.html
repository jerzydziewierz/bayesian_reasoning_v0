---

title: Not a different way to do reasoning


keywords: fastai
sidebar: home_sidebar

summary: "After reading this, you will be able to use Bayesian reasoning for your project."
description: "After reading this, you will be able to use Bayesian reasoning for your project."
nb_path: "index.ipynb"
---
<!--

#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: index.ipynb
# command to build the docs after a change: nbdev_build_docs

-->

<div class="container" id="notebook-container">
        
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Who-should-read-this">Who should read this<a class="anchor-link" href="#Who-should-read-this"> </a></h2><p>If you had a look at a pro toolbox like <a href="https://docs.pymc.io/">PYMC3</a> and you feel like you banged yer head, this is the place to get it mended.</p>
<p><strong>My promise is this</strong>: After reading this, you will be able to use Bayesian reasoning for your project, and use more advanced books.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="What-happened.">What happened.<a class="anchor-link" href="#What-happened."> </a></h2><p>I do not normally write blog posts.</p>
<p>Today is not a normal day tough.</p>
<p>I believe that I have found a missing link in my understanding of bayesian modelling theory.</p>
<p>This is not so much about the bayes belief update equation. It's good. The problem is that the notation is confusing, making it difficult to distinguish and source(compute, obtain) the various terms in the equation, and connect themto the real-world phenomena.</p>
<p>If you have been paying attention at school, you might think that bayes update rule:</p>
<p>{% raw %}
$$p( A | B) = \frac{p(B|A)p(A)}{p(B)}$$
{% endraw %}</p>
<blockquote><p><a href="https://en.wikipedia.org/wiki/Bayes%27_theorem">wikipedia:Bayes Theorem</a>&gt; &gt; <img src="https://upload.wikimedia.org/wikipedia/commons/thumb/1/18/Bayes%27_Theorem_MMB_01.jpg/220px-Bayes%27_Theorem_MMB_01.jpg" alt=""></p>
</blockquote>
<p>You might think that this equation is all that it takes.</p>
<p>By looking at the examples in the wiki, you might even get a feeling that you understand it.</p>
<p>However, How does one apply this to problem X that is not described in the wiki?</p>
<p>It turns out that even professional data scientists (that I have met) are confused as to how to use this simple equation in practice.</p>
<p>In this write-up, I will explain why, what to do about it, and give a fairly universal live demo that can be adapted and extended for your problem.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Install-the-toolbox">Install the toolbox<a class="anchor-link" href="#Install-the-toolbox"> </a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><code>pip install git+https://github.com/jerzydziewierz/bayesian_reasoning_v0.git</code></p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="How-to-use">How to use<a class="anchor-link" href="#How-to-use"> </a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Read the <a href="https://jerzydziewierz.github.io/bayesian_reasoning_v0/10-gr-bayesian-modeling-missing-link.html">chapter 1</a>.  (link here when I figure out how to add it)</p>
<p>Then use the the example provided to express your problem as a belief update problem. Profit!</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="I-want-a-quicker-way.">I want a quicker way.<a class="anchor-link" href="#I-want-a-quicker-way."> </a></h2><p>Here you go:</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">bayesian_reasoning_v0.core</span> <span class="kn">import</span> <span class="o">*</span>
<span class="kn">from</span> <span class="nn">lib.lib_nicefloat</span> <span class="kn">import</span> <span class="o">*</span>
<span class="kn">import</span> <span class="nn">numpy</span>

<span class="n">ja</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">jax</span><span class="o">.</span><span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Assume that our plant is a classic coin.</p>
<p>Assume that we can model it with a hidden parameter $\phi$</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">coin_model</span><span class="p">(</span><span class="n">real_hidden_phi</span><span class="o">=</span><span class="mf">0.5</span> <span class="p">,</span><span class="n">observation_count</span><span class="o">=</span><span class="mi">10</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    a model of a coin: simulates coin tosses.</span>
<span class="sd">    </span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">observations</span> <span class="o">=</span> <span class="n">jax</span><span class="o">.</span><span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">numpy</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">random</span><span class="p">(</span><span class="n">observation_count</span><span class="p">)</span><span class="o">&lt;</span><span class="n">real_hidden_phi</span><span class="p">,</span><span class="n">dtype</span><span class="o">=</span><span class="n">jax</span><span class="o">.</span><span class="n">numpy</span><span class="o">.</span><span class="n">int32</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">observation_count</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">observations</span>

<span class="n">pd</span><span class="p">(</span><span class="n">coin_model</span><span class="p">(</span><span class="n">observation_count</span> <span class="o">=</span> <span class="mi">3</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>[[D=  1  ],
 [D=  1  ],
 [D=  1  ]]</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>In this example, we will consider 3 possible values for $\phi$ : $\{\phi\} = [0.2, 0.5, 0.8] $</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># note that the convention is to put phis in column headers column headers</span>
<span class="n">phi_set</span> <span class="o">=</span> <span class="n">ja</span><span class="p">([</span><span class="mf">0.2</span><span class="p">,</span><span class="mf">0.5</span><span class="p">,</span><span class="mf">0.8</span><span class="p">])</span>
<span class="n">pf</span><span class="p">(</span><span class="n">phi_set</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>[φ=0.200  , φ=0.500  , φ=0.800  ]</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Here are possible prior beliefs to try:</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># no bias belief: we think that the coin is not biased.</span>
<span class="n">prior_belief_set_fair</span> <span class="o">=</span> <span class="n">ja</span><span class="p">([</span><span class="mf">0.1</span><span class="p">,</span><span class="mf">0.8</span><span class="p">,</span><span class="mf">0.1</span><span class="p">])</span>

<span class="c1"># high bias belief: we think that the coin is biased.</span>
<span class="n">prior_belief_set_bias_0</span> <span class="o">=</span> <span class="n">ja</span><span class="p">([</span><span class="mf">0.8</span><span class="p">,</span><span class="mf">0.1</span><span class="p">,</span><span class="mf">0.1</span><span class="p">])</span>

<span class="c1"># high bias belief: we think that the coin is biased towards ones.</span>
<span class="n">prior_belief_set_bias_1</span> <span class="o">=</span> <span class="n">jax</span><span class="o">.</span><span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.1</span><span class="p">,</span><span class="mf">0.1</span><span class="p">,</span><span class="mf">0.8</span><span class="p">])</span>

<span class="c1"># uninformative: We know that we don&#39;t know. </span>
<span class="n">prior_belief_set_uninformative</span> <span class="o">=</span> <span class="n">jax</span><span class="o">.</span><span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.3333</span><span class="p">,</span><span class="mf">0.3333</span><span class="p">,</span><span class="mf">0.3333</span><span class="p">])</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">pb</span><span class="p">(</span><span class="n">prior_belief_set_uninformative</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>[    333mR,     333mR,     333mR]</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>For repeatability, here are example observation sets to try:</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># note that the convention is to put observations in rows of the table.</span>
<span class="n">observation_single_1</span> <span class="o">=</span> <span class="n">ja</span><span class="p">([[</span><span class="mi">1</span><span class="p">]])</span> <span class="c1"># note: need a categorical variable here - and only &quot;1&quot; or &quot;0&quot;</span>
<span class="n">observation_single_0</span> <span class="o">=</span> <span class="n">ja</span><span class="p">([[</span><span class="mi">0</span><span class="p">]])</span> <span class="c1"># note: need a categorical variable here - and only &quot;1&quot; or &quot;0&quot;</span>
<span class="n">observation_small_set_0</span> <span class="o">=</span> <span class="n">ja</span><span class="p">([[</span><span class="mi">0</span><span class="p">],[</span><span class="mi">0</span><span class="p">]])</span>
<span class="n">observation_small_set_balanced</span> <span class="o">=</span> <span class="n">ja</span><span class="p">([[</span><span class="mi">0</span><span class="p">],[</span><span class="mi">1</span><span class="p">]])</span>
<span class="n">observation_small_set_1</span> <span class="o">=</span> <span class="n">ja</span><span class="p">([[</span><span class="mi">1</span><span class="p">],[</span><span class="mi">1</span><span class="p">]])</span>
<span class="n">observation_large_set_neutral</span> <span class="o">=</span> <span class="n">ja</span><span class="p">([[</span><span class="mi">1</span><span class="p">],[</span><span class="mi">1</span><span class="p">],[</span><span class="mi">1</span><span class="p">],[</span><span class="mi">1</span><span class="p">],[</span><span class="mi">0</span><span class="p">],[</span><span class="mi">0</span><span class="p">],[</span><span class="mi">0</span><span class="p">],[</span><span class="mi">0</span><span class="p">]])</span>
<span class="n">observation_large_set_biased</span> <span class="o">=</span> <span class="n">ja</span><span class="p">([[</span><span class="mi">1</span><span class="p">],[</span><span class="mi">1</span><span class="p">],[</span><span class="mi">1</span><span class="p">],[</span><span class="mi">1</span><span class="p">],[</span><span class="mi">0</span><span class="p">],[</span><span class="mi">0</span><span class="p">]])</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">pd</span><span class="p">(</span><span class="n">observation_small_set_balanced</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>[[D=  0  ],
 [D=  1  ]]</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">this_observation_set</span> <span class="o">=</span> <span class="n">observation_small_set_0</span>
<span class="n">this_phi_prior_belief_set</span> <span class="o">=</span> <span class="n">prior_belief_set_uninformative</span>

<span class="n">posterior_belief_set</span><span class="o">=</span><span class="n">BayesianBeliefUpdate</span><span class="p">(</span>
                        <span class="n">phi_set</span> <span class="o">=</span> <span class="n">phi_set</span><span class="p">,</span>
                        <span class="n">phi_prior_belief_set</span><span class="o">=</span><span class="n">this_phi_prior_belief_set</span><span class="p">,</span>
                        <span class="n">observations</span><span class="o">=</span><span class="n">this_observation_set</span><span class="p">,</span>
                        <span class="n">likelihood_fn</span><span class="o">=</span><span class="n">likelihood_observation_set_fn</span><span class="p">,</span>
                        <span class="n">marginal_probability_fn</span> <span class="o">=</span> <span class="n">marginal_fn</span><span class="p">)</span>

<span class="n">BayesianBeliefUpdateReport</span><span class="p">(</span>
                        <span class="n">phi_set</span> <span class="o">=</span> <span class="n">phi_set</span><span class="p">,</span>
                        <span class="n">phi_prior_belief_set</span><span class="o">=</span><span class="n">this_phi_prior_belief_set</span><span class="p">,</span>
                        <span class="n">observations</span><span class="o">=</span><span class="n">this_observation_set</span><span class="p">,</span>
                        <span class="n">posterior_belief_set</span><span class="o">=</span><span class="n">posterior_belief_set</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>for observations {D}: 
[[D=  0  ],
 [D=  0  ]]

for parameter set      {φ}  = [φ=0.200  , φ=0.500  , φ=0.800  ]
and prior belief set b({φ}) = [    333mR,     333mR,     333mR]

for model parameter φ=0.200   with PriorBelief =     333mR, UpdatedBelief =     688mR, change of  +355mR 
for model parameter φ=0.500   with PriorBelief =     333mR, UpdatedBelief =     269mR, change of   -64mR 
for model parameter φ=0.800   with PriorBelief =     333mR, UpdatedBelief =      43mR, change of  -290mR 


                       {φ}  = [φ=0.200  , φ=0.500  , φ=0.800  ]
posterior belief set b({φ}) = [    688mR,     269mR,      43mR]
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="I-am-not-convinced">I am not convinced<a class="anchor-link" href="#I-am-not-convinced"> </a></h2><p>Contact me on LinkedIn and tell me why I am wrong.</p>
<p><a href="https://www.linkedin.com/in/dr-george-rey-dziewierz/">https://www.linkedin.com/in/dr-george-rey-dziewierz/</a></p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<hr>

</div>
</div>
</div>
</div>
 

