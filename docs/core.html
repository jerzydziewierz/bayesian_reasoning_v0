---

title: bayes_coin_flip


keywords: fastai
sidebar: home_sidebar

summary: "Implementation of bayesian reasoning on a coin-flip like scenario with finite list $\{p\}$ of possible latent parameter $p$"
description: "Implementation of bayesian reasoning on a coin-flip like scenario with finite list $\{p\}$ of possible latent parameter $p$"
nb_path: "00_core.ipynb"
---
<!--

#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: 00_core.ipynb
# command to build the docs after a change: nbdev_build_docs

-->

<div class="container" id="notebook-container">
        
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre>WARNING:absl:No GPU/TPU found, falling back to CPU. (Set TF_CPP_MIN_LOG_LEVEL=0 and rerun for more info.)
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="coin_model" class="doc_header"><code>coin_model</code><a href="https://github.com/jerzydziewierz/bayesian_reasoning_v0/tree/master/bayesian_reasoning_v0/core.py#L15" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>coin_model</code>(<strong><code>real_hidden_phi</code></strong>=<em><code>0.5</code></em>, <strong><code>observation_count</code></strong>=<em><code>10</code></em>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="likelihood_vector_fn" class="doc_header"><code>likelihood_vector_fn</code><a href="https://github.com/jerzydziewierz/bayesian_reasoning_v0/tree/master/bayesian_reasoning_v0/core.py#L57" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>likelihood_vector_fn</code>(<strong><code>observations</code></strong>, <strong><code>phis</code></strong>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="likelihood_observation_set_fn" class="doc_header"><code>likelihood_observation_set_fn</code><a href="https://github.com/jerzydziewierz/bayesian_reasoning_v0/tree/master/bayesian_reasoning_v0/core.py#L63" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>likelihood_observation_set_fn</code>(<strong><code>observations</code></strong>, <strong><code>phi</code></strong>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="marginal_fn" class="doc_header"><code>marginal_fn</code><a href="https://github.com/jerzydziewierz/bayesian_reasoning_v0/tree/master/bayesian_reasoning_v0/core.py#L67" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>marginal_fn</code>(<strong><code>observations</code></strong>, <strong><code>likelihood_function</code></strong>, <strong><code>phi_set</code></strong>, <strong><code>prior_belief_set</code></strong>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="BayesianBeliefUpdate_singlePhi" class="doc_header"><code>BayesianBeliefUpdate_singlePhi</code><a href="https://github.com/jerzydziewierz/bayesian_reasoning_v0/tree/master/bayesian_reasoning_v0/core.py#L73" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>BayesianBeliefUpdate_singlePhi</code>(<strong><code>this_phi</code></strong>, <strong><code>this_phi_prior_belief</code></strong>, <strong><code>phi_set</code></strong>, <strong><code>phi_prior_belief_set</code></strong>, <strong><code>observations</code></strong>, <strong><code>likelihood_fn</code></strong>, <strong><code>marginal_probability_fn</code></strong>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="BayesianBeliefUpdate" class="doc_header"><code>BayesianBeliefUpdate</code><a href="https://github.com/jerzydziewierz/bayesian_reasoning_v0/tree/master/bayesian_reasoning_v0/core.py#L83" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>BayesianBeliefUpdate</code>(<strong><code>phi_set</code></strong>, <strong><code>phi_prior_belief_set</code></strong>, <strong><code>observations</code></strong>, <strong><code>likelihood_fn</code></strong>, <strong><code>marginal_probability_fn</code></strong>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="BayesianBeliefUpdateReport" class="doc_header"><code>BayesianBeliefUpdateReport</code><a href="https://github.com/jerzydziewierz/bayesian_reasoning_v0/tree/master/bayesian_reasoning_v0/core.py#L104" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>BayesianBeliefUpdateReport</code>(<strong><code>phi_set</code></strong>=<em><code>DeviceArray([0.2, 0.5, 0.8], dtype=float32)</code></em>, <strong><code>phi_prior_belief_set</code></strong>=<em><code>DeviceArray([0.3333, 0.3333, 0.3333], dtype=float32)</code></em>, <strong><code>observations</code></strong>=<em><code>DeviceArray([[0],
             [1]], dtype=int32)</code></em>, <strong><code>posterior_belief_set</code></strong>=<em><code>DeviceArray([0.3333, 0.3333, 0.3333], dtype=float32)</code></em>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">this_observation_set</span> <span class="o">=</span> <span class="n">observation_small_set_0</span>
<span class="n">this_phi_prior_belief_set</span> <span class="o">=</span> <span class="n">prior_belief_set_uninformative</span>

<span class="n">posterior_belief_set</span><span class="o">=</span><span class="n">BayesianBeliefUpdate</span><span class="p">(</span>
                        <span class="n">phi_set</span> <span class="o">=</span> <span class="n">phi_set</span><span class="p">,</span>
                        <span class="n">phi_prior_belief_set</span><span class="o">=</span><span class="n">this_phi_prior_belief_set</span><span class="p">,</span>
                        <span class="n">observations</span><span class="o">=</span><span class="n">this_observation_set</span><span class="p">,</span>
                        <span class="n">likelihood_fn</span><span class="o">=</span><span class="n">likelihood_observation_set_fn</span><span class="p">,</span>
                        <span class="n">marginal_probability_fn</span> <span class="o">=</span> <span class="n">marginal_fn</span><span class="p">)</span>

<span class="n">BayesianBeliefUpdateReport</span><span class="p">(</span>
                        <span class="n">phi_set</span> <span class="o">=</span> <span class="n">phi_set</span><span class="p">,</span>
                        <span class="n">phi_prior_belief_set</span><span class="o">=</span><span class="n">this_phi_prior_belief_set</span><span class="p">,</span>
                        <span class="n">observations</span><span class="o">=</span><span class="n">this_observation_set</span><span class="p">,</span>
                        <span class="n">posterior_belief_set</span><span class="o">=</span><span class="n">posterior_belief_set</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">pd</span><span class="p">(</span><span class="n">observation_large_set_biased</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">pd</span><span class="p">(</span><span class="n">coin_model</span><span class="p">(</span><span class="n">real_hidden_phi</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">observation_count</span> <span class="o">=</span><span class="mi">5</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">pf</span><span class="p">(</span><span class="n">phi_set</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">pl</span><span class="p">(</span><span class="n">likelihood_observation_set_fn</span><span class="p">(</span><span class="n">observations</span><span class="o">=</span><span class="n">observation_single_1</span><span class="p">,</span><span class="n">phi</span><span class="o">=</span><span class="n">ja</span><span class="p">([</span><span class="mf">0.5</span><span class="p">])))</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">assert</span> <span class="n">likelihood_observation_set_fn</span><span class="p">(</span><span class="n">observations</span><span class="o">=</span><span class="n">observation_single_1</span><span class="p">,</span><span class="n">phi</span><span class="o">=</span><span class="n">ja</span><span class="p">([</span><span class="mf">0.5</span><span class="p">]))</span><span class="o">==</span><span class="mf">0.5</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">pl</span><span class="p">(</span><span class="n">likelihood_vector_fn</span><span class="p">(</span><span class="n">observation_large_set_neutral</span><span class="p">,</span><span class="n">phi_set</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">nbdev.export</span> <span class="kn">import</span> <span class="n">notebook2script</span><span class="p">;</span> <span class="n">notebook2script</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

</div>
 

